(function(a,b){dshopmods.add("scrollbox",function(){var d=function(f,g,e){this.data=g;this.wrap=f;this.size=e||4;this.scrollid="#J_SCROLLBOX"+new Date().valueOf();this.scrollwrap="#J_SCROLLWRAP"+new Date().valueOf();this.item=".J_Item"+new Date().valueOf()};var c={batchdata:function(g,f){b.each(g.data,function(h,i){if(h%f==0){i.separate_front=true}if(h%f==f-1){i.separate_behind=true}});g.actived=[];for(var e=0;e<Math.ceil(g.data.length/f);e++){g.actived.push(e)}return g}};d.prototype={init:function(){var e=this;e.createhtml(e.data,e.wrap)},createhtml:function(g,e){var f=this;dshop.use("carousel",function(){var k=c.batchdata(f.data,f.size),h='<div class="list_odds"><div class="ls_title1 ks_clear"><p id="'+f.scrollid.slice(1)+'">{{#actived}}<span></span>{{/actived}}</p>{{title}}</div><div class="odds_txt ks_clear"><div id="'+f.scrollwrap.slice(1)+'">{{#data}}{{#separate_front}}<ul class="'+f.item.slice(1)+'">{{/separate_front}}<li><div class="odds_img"><a href="{{url}}"><img src="{{pic}}"></a></div><p><a href="{{url}}">{{title}}</a></p><span>&yen;<b class="red">{{price}}</b></span></li>{{#separate_behind}}</ul>{{/separate_behind}}{{/data}}</div></div></div>';var i=dshop.mods.template.to_html(h,k);b(e).html(i);b(f.scrollid).find("span:first").addClass("active");if(b(f.scrollwrap+">ul:last>li").length!=f.size){var j=f.size-(b(f.scrollwrap+">ul:last>li").length%f.size),l=b(f.scrollwrap+">ul:first>li").slice(0,j).clone();b(f.scrollwrap+">ul:last").append(l)}f.bindevent()},["template"])},bindevent:function(){var e=this;var f=new dshop.mods.carousel({wrap:e.scrollwrap,wrapitem:e.item,direction:"top"});b(e.scrollid).find("span").live("click",function(h){var g=b(this).index(e.scrollid+">span");b(e.scrollid).find("span").removeClass("active");b(this).addClass("active");f.to(g)})}};dshopmods.mods.scrollbox=d})})(window,jQuery);